<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:6,&quot;tests&quot;:28,&quot;passes&quot;:28,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2019-06-09T08:35:05.661Z&quot;,&quot;end&quot;:&quot;2019-06-09T08:35:06.430Z&quot;,&quot;duration&quot;:769,&quot;testsRegistered&quot;:28,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;7c38ac55-2010-488e-a29d-020645004004&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;c1109a6a-e683-4b6c-8fc7-6184b489a79e&quot;,&quot;title&quot;:&quot;Async modules test&quot;,&quot;fullFile&quot;:&quot;/var/www/gabriela/tests/unit/asyncModules.spec.js&quot;,&quot;file&quot;:&quot;/tests/unit/asyncModules.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should assert the first time that next proceedes to next middleware with an async function inside middleware&quot;,&quot;fullTitle&quot;:&quot;Async modules test should assert the first time that next proceedes to next middleware with an async function inside middleware&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:136,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;googleCall&#x27;;\nconst googleRequest = function(state, next) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.googleBody = body;\n        next();\n    });\n};\nconst mdl = {\n    name: name,\n    moduleLogic: [googleRequest]\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult).to.have.property(&#x27;googleBody&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;662814d2-26ba-4c81-a04a-f606505d163c&quot;,&quot;parentUUID&quot;:&quot;c1109a6a-e683-4b6c-8fc7-6184b489a79e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert the second time that next proceedes to next middleware with an async function inside middleware&quot;,&quot;fullTitle&quot;:&quot;Async modules test should assert the second time that next proceedes to next middleware with an async function inside middleware&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:84,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;googleCall&#x27;;\nconst googleRequest = function(state, next) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.googleBody = body;\n        next();\n    });\n};\nconst mdl = {\n    name: name,\n    moduleLogic: [googleRequest]\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult).to.have.property(&#x27;googleBody&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8f5668d3-d197-4a83-badd-87eb98e8c1c9&quot;,&quot;parentUUID&quot;:&quot;c1109a6a-e683-4b6c-8fc7-6184b489a79e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert that skip skips the rest of the middleware&quot;,&quot;fullTitle&quot;:&quot;Async modules test should assert that skip skips the rest of the middleware&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:176,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;googleCall&#x27;;\nconst firstRequest = function(state, next) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.firstRequest = body;\n        next();\n    });\n};\nconst secondRequest = function(state, next, skip) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.secondRequest = body;\n        skip();\n    });\n};\nconst thirdRequest = function(state, next) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.thirdRequest = body;\n        next();\n    });\n};\nconst postLogicTransformer = function(state, next) {\n    state.postLogic = true;\n    next();\n};\nconst mdl = {\n    name: name,\n    moduleLogic: [firstRequest, secondRequest, thirdRequest],\n    postLogicTransformers: [postLogicTransformer]\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult).to.have.property(&#x27;firstRequest&#x27;);\n    expect(moduleResult).to.have.property(&#x27;secondRequest&#x27;);\n    expect(moduleResult).to.not.have.property(&#x27;thirdRequest&#x27;);\n    expect(moduleResult).to.have.property(&#x27;postLogic&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e0990ac7-eddf-4f0f-833c-b459df708246&quot;,&quot;parentUUID&quot;:&quot;c1109a6a-e683-4b6c-8fc7-6184b489a79e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;it should assert that done() exists and does not execute any more middleware&quot;,&quot;fullTitle&quot;:&quot;Async modules test it should assert that done() exists and does not execute any more middleware&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:187,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;googleCall&#x27;;\nconst firstRequest = function(state, next) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.firstRequest = body;\n        next();\n    });\n};\nconst secondRequest = function(state, next, skip, done) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.secondRequest = body;\n        done();\n    });\n};\nconst thirdRequest = function(state, next) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.thirdRequest = body;\n        next();\n    });\n};\nconst postLogicTransformer = function(state, next) {\n    state.postLogic = true;\n    next();\n};\nconst mdl = {\n    name: name,\n    moduleLogic: [firstRequest, secondRequest, thirdRequest],\n    postLogicTransformers: [postLogicTransformer]\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult).to.have.property(&#x27;firstRequest&#x27;);\n    expect(moduleResult).to.have.property(&#x27;secondRequest&#x27;);\n    expect(moduleResult).to.not.have.property(&#x27;thirdRequest&#x27;);\n    expect(moduleResult).to.not.have.property(&#x27;postLogic&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a495381e-8a81-496f-8ae0-560b3c60955c&quot;,&quot;parentUUID&quot;:&quot;c1109a6a-e683-4b6c-8fc7-6184b489a79e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert that exception throw inside middleware async process is caught and processed&quot;,&quot;fullTitle&quot;:&quot;Async modules test should assert that exception throw inside middleware async process is caught and processed&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:92,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;googleCall&#x27;;\nconst firstRequest = function(state, next, skip, done, throwException) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.firstRequest = body;\n        throwException(new Error(&#x27;my exception&#x27;));\n    });\n};\nconst secondRequest = function(state, next, skip, done) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.secondRequest = body;\n        done();\n    });\n};\nconst mdl = {\n    name: name,\n    moduleLogic: [firstRequest, secondRequest],\n    postLogicTransformers: []\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n}).catch((err) =&gt; {\n    expect(err.message).to.be.equal(&#x27;my exception&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3a0fc169-0e95-411e-a50a-ee9d7fa2841a&quot;,&quot;parentUUID&quot;:&quot;c1109a6a-e683-4b6c-8fc7-6184b489a79e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;662814d2-26ba-4c81-a04a-f606505d163c&quot;,&quot;8f5668d3-d197-4a83-badd-87eb98e8c1c9&quot;,&quot;e0990ac7-eddf-4f0f-833c-b459df708246&quot;,&quot;a495381e-8a81-496f-8ae0-560b3c60955c&quot;,&quot;3a0fc169-0e95-411e-a50a-ee9d7fa2841a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:675,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;b1115ede-cfd8-47a8-aa75-94658b5d57cf&quot;,&quot;title&quot;:&quot;Dependency injection tests&quot;,&quot;fullFile&quot;:&quot;/var/www/gabriela/tests/unit/dependencyInjection.spec.js&quot;,&quot;file&quot;:&quot;/tests/unit/dependencyInjection.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create a single dependency&quot;,&quot;fullTitle&quot;:&quot;Dependency injection tests should create a single dependency&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const userServiceInit = {\n    name: &#x27;userService&#x27;,\n    init: function() {\n        function userService() {\n            this.addUser = function() {};\n            this.removeUser = function() {};\n        }\n        return new userService();\n    }\n};\nconst compiler = Compiler.create();\ncompiler.add(userServiceInit);\nconst userService = compiler.compile(&#x27;userService&#x27;);\nexpect(userService).to.have.property(&#x27;addUser&#x27;);\nexpect(userService).to.have.property(&#x27;removeUser&#x27;);\nlet us1 = compiler.compile(&#x27;userService&#x27;);\nexpect(userService).to.be.equal(us1);\nexpect(us1 == userService).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1d0e9eca-f002-4933-980c-d3fda70940b3&quot;,&quot;parentUUID&quot;:&quot;b1115ede-cfd8-47a8-aa75-94658b5d57cf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should create a tree of dependencies&quot;,&quot;fullTitle&quot;:&quot;Dependency injection tests should create a tree of dependencies&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const commentServiceInit = {\n    name: &#x27;commentService&#x27;,\n    init: function() {\n        function commentService() {\n            this.addComment = function() {};\n            this.removeComment = function() {};\n        }\n        return new commentService();\n    }\n};\nconst userServiceInit = {\n    name: &#x27;userService&#x27;,\n    init: function(commentService) {\n        function userService() {\n            this.addUser = function() {};\n            this.removeUser = function() {};\n            this.commentService = commentService;\n        }\n        return new userService();\n    }\n};\nconst compiler = Compiler.create();\ncompiler.add(userServiceInit);\ncompiler.add(commentServiceInit);\nconst userService = compiler.compile(&#x27;userService&#x27;);\nexpect(userService).to.have.property(&#x27;addUser&#x27;);\nexpect(userService).to.have.property(&#x27;removeUser&#x27;);\nexpect(userService).to.have.property(&#x27;commentService&#x27;);\nconst commentService = userService.commentService;\nexpect(commentService).to.have.property(&#x27;addComment&#x27;);\nexpect(commentService).to.have.property(&#x27;removeComment&#x27;);\nlet cs1 = compiler.compile(&#x27;commentService&#x27;);\nexpect(cs1 == commentService).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;970fadf5-f82a-446d-a238-c4d2716ca408&quot;,&quot;parentUUID&quot;:&quot;b1115ede-cfd8-47a8-aa75-94658b5d57cf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should resolve dependencies private to a module&quot;,&quot;fullTitle&quot;:&quot;Dependency injection tests should resolve dependencies private to a module&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const commentServiceInit = {\n    name: &#x27;commentService&#x27;,\n    init: function() {\n        function commentService() {\n            this.addComment = function() {};\n            this.removeComment = function() {};\n        }\n        return new commentService();\n    }\n};\nconst userServiceInit = {\n    name: &#x27;userService&#x27;,\n    init: function(commentService) {\n        function userService() {\n            this.addUser = function() {};\n            this.removeUser = function() {};\n            this.commentService = commentService;\n        }\n        return new userService();\n    }\n};&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0e88e6b9-3401-46e4-a5db-9dd1e3d5dbee&quot;,&quot;parentUUID&quot;:&quot;b1115ede-cfd8-47a8-aa75-94658b5d57cf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should resolve all dependencies with visibility property&quot;,&quot;fullTitle&quot;:&quot;Dependency injection tests should resolve all dependencies with visibility property&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const visibilities = [&#x27;module&#x27;, &#x27;plugin&#x27;, &#x27;public&#x27;];\nlet entersException = false;\nconst compiler = Compiler.create();\nfor (const v of visibilities) {\n    entersException = false;\n    try {\n        compiler.add({\n            name: &#x27;name&#x27;,\n            visibility: v,\n            init: function() {\n                return () =&gt; {};\n            },\n        });\n    } catch (err) {\n        entersException = true;\n    }\n    expect(entersException).to.be.equal(false);\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f4485b2f-215b-452c-a88a-4f32516355b3&quot;,&quot;parentUUID&quot;:&quot;b1115ede-cfd8-47a8-aa75-94658b5d57cf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1d0e9eca-f002-4933-980c-d3fda70940b3&quot;,&quot;970fadf5-f82a-446d-a238-c4d2716ca408&quot;,&quot;0e88e6b9-3401-46e4-a5db-9dd1e3d5dbee&quot;,&quot;f4485b2f-215b-452c-a88a-4f32516355b3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;c5fdd641-4e51-414a-9055-9a00f563873d&quot;,&quot;title&quot;:&quot;Failing server tests&quot;,&quot;fullFile&quot;:&quot;/var/www/gabriela/tests/unit/errors.spec.js&quot;,&quot;file&quot;:&quot;/tests/unit/errors.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should validate server options and throw exception&quot;,&quot;fullTitle&quot;:&quot;Failing server tests should validate server options and throw exception&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let entersException = false;\ntry {\n    gabriela.asServer({\n        port: &#x27;invalid&#x27;,\n    });\n} catch (err) {\n    entersException = true;\n}\nexpect(entersException).to.be.equal(true);\ntry {\n    gabriela.asServer({\n        port: 3000,\n        runCallback: null,\n    });\n} catch (err) {\n    entersException = true;\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1b9210fc-5e95-441c-ad39-f624ab29aee3&quot;,&quot;parentUUID&quot;:&quot;c5fdd641-4e51-414a-9055-9a00f563873d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1b9210fc-5e95-441c-ad39-f624ab29aee3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;14d8c3a0-1112-4fe4-b047-47101c567830&quot;,&quot;title&quot;:&quot;Failing DI compiler tests&quot;,&quot;fullFile&quot;:&quot;/var/www/gabriela/tests/unit/errors.spec.js&quot;,&quot;file&quot;:&quot;/tests/unit/errors.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should fail to compile a dependency because invalid isAsync option type&quot;,&quot;fullTitle&quot;:&quot;Failing DI compiler tests should fail to compile a dependency because invalid isAsync option type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const userServiceInit = {\n    name: &#x27;userService&#x27;,\n    isAsync: 1,\n    init: function() {\n        return () =&gt; {};\n    }\n};\nconst compiler = Compiler.create();\nlet entersException = false;\ntry {\n    compiler.add(userServiceInit);\n} catch (err) {\n    entersException = true;\n    expect(err.message).to.be.equal(`Dependency injection error. &#x27;isAsync&#x27; option must be a boolean`);\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;649aa849-df48-463c-a563-7ad2705c7da2&quot;,&quot;parentUUID&quot;:&quot;14d8c3a0-1112-4fe4-b047-47101c567830&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail to compile a dependency because init.init does not return a function&quot;,&quot;fullTitle&quot;:&quot;Failing DI compiler tests should fail to compile a dependency because init.init does not return a function&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const userServiceInit = {\n    name: &#x27;userService&#x27;,\n    init: function() {\n        // returns nothing\n    }\n};\nconst compiler = Compiler.create();\ncompiler.add(userServiceInit);\nlet entersException = false;\ntry {\n    compiler.compile(&#x27;userService&#x27;);\n} catch (err) {\n    entersException = true;\n    expect(err.message).to.be.equal(`Dependency injection error. Target service userService cannot be a falsy value`)\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7bdef713-d801-4a06-bc37-dec330248a10&quot;,&quot;parentUUID&quot;:&quot;14d8c3a0-1112-4fe4-b047-47101c567830&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail to compile a dependency because of non existent service&quot;,&quot;fullTitle&quot;:&quot;Failing DI compiler tests should fail to compile a dependency because of non existent service&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let entersException = false;\nconst compiler = Compiler.create();\ntry {\n    compiler.compile(&#x27;nonExistentService&#x27;);\n} catch (err) {\n    entersException = true;\n    expect(err.message).to.be.equal(`Dependency injection error. nonExistentService not found in the dependency tree`)\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dc31c4ed-d43c-4404-893c-03cee04df958&quot;,&quot;parentUUID&quot;:&quot;14d8c3a0-1112-4fe4-b047-47101c567830&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail to compile because init dependency value not being an object&quot;,&quot;fullTitle&quot;:&quot;Failing DI compiler tests should fail to compile because init dependency value not being an object&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let entersException = false;\nconst compiler = Compiler.create();\ntry {\n    compiler.add(1);\n} catch (err) {\n    entersException = true;\n    expect(err.message).to.be.equal(`Dependency injection error. &#x27;init&#x27; dependency value must be an object`);\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e5b06212-a060-410d-9b21-d285e34fe1dd&quot;,&quot;parentUUID&quot;:&quot;14d8c3a0-1112-4fe4-b047-47101c567830&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail to compile a dependency because name property must be a string&quot;,&quot;fullTitle&quot;:&quot;Failing DI compiler tests should fail to compile a dependency because name property must be a string&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let entersException = false;\nconst compiler = Compiler.create();\ntry {\n    compiler.add({\n        name: 1\n    });\n} catch (err) {\n    entersException = true;\n    expect(err.message).to.be.equal(`Dependency injection error. Init object &#x27;name&#x27; property must be a string`);\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b19cc774-0ec7-430c-9b36-b2acab039de6&quot;,&quot;parentUUID&quot;:&quot;14d8c3a0-1112-4fe4-b047-47101c567830&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail to compile a dependency because init.init must be a function&quot;,&quot;fullTitle&quot;:&quot;Failing DI compiler tests should fail to compile a dependency because init.init must be a function&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let entersException = false;\nconst compiler = Compiler.create();\ntry {\n    compiler.add({\n        name: &#x27;name&#x27;,\n        init: 1,\n    });\n} catch (err) {\n    entersException = true;\n    expect(err.message).to.be.equal(`Dependency injection error. Init object &#x27;init&#x27; property must be a function`);\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7aeb83de-ae2d-45f0-a3b1-3c8f26f394c6&quot;,&quot;parentUUID&quot;:&quot;14d8c3a0-1112-4fe4-b047-47101c567830&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail to compile because of invalid service name data type&quot;,&quot;fullTitle&quot;:&quot;Failing DI compiler tests should fail to compile because of invalid service name data type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let entersException = false;\nconst compiler = Compiler.create();\nlet invalidService = {\n    name: 1,\n};\ntry {\n    compiler.add(invalidService);\n} catch (err) {\n    entersException = true;\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;33fe006e-6d31-4c08-b073-2aec8c4854c9&quot;,&quot;parentUUID&quot;:&quot;14d8c3a0-1112-4fe4-b047-47101c567830&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;649aa849-df48-463c-a563-7ad2705c7da2&quot;,&quot;7bdef713-d801-4a06-bc37-dec330248a10&quot;,&quot;dc31c4ed-d43c-4404-893c-03cee04df958&quot;,&quot;e5b06212-a060-410d-9b21-d285e34fe1dd&quot;,&quot;b19cc774-0ec7-430c-9b36-b2acab039de6&quot;,&quot;7aeb83de-ae2d-45f0-a3b1-3c8f26f394c6&quot;,&quot;33fe006e-6d31-4c08-b073-2aec8c4854c9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;33fc72dd-0b6b-44d2-985b-ac917d91160d&quot;,&quot;title&quot;:&quot;Http request to gabriela&quot;,&quot;fullFile&quot;:&quot;/var/www/gabriela/tests/unit/http.spec.js&quot;,&quot;file&quot;:&quot;/tests/unit/http.spec.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Http request to gabriela \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const usersListModule = {\n    http: {\n        route: {\n            name: &#x27;usersList&#x27;,\n            path: &#x27;/users&#x27;,\n            method: &#x27;get&#x27;,\n        }\n    },\n    name: &#x27;name&#x27;,\n    moduleLogic: [(state, next, skip, done, throwException, http) =&gt; {\n        http.res.send(&#x27;OK&#x27;);\n        http.res.end();\n        done();\n    }],\n};\ngabrielaServer = gabriela.asServer({\n    port: 3001,\n    runCallback: () =&gt; {\n        done();\n    }\n});\ngabrielaServer.addModule(usersListModule);\ngabrielaServer.runServer();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dcc433e9-8a33-4e2a-8229-75069192a0a3&quot;,&quot;parentUUID&quot;:&quot;33fc72dd-0b6b-44d2-985b-ac917d91160d&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Http request to gabriela \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;gabrielaServer.closeServer();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ceb7a3e3-52d8-4bae-a327-cb0b01f8f598&quot;,&quot;parentUUID&quot;:&quot;33fc72dd-0b6b-44d2-985b-ac917d91160d&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;should accept a GET request and return a response&quot;,&quot;fullTitle&quot;:&quot;Http request to gabriela should accept a GET request and return a response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;requestPromise(&#x27;http://11.11.11.12:3001/users&#x27;).then((body) =&gt; {\n    expect(body).to.be.equal(&#x27;OK&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9700a15f-4a1c-4998-939b-bd6cd2b90e6f&quot;,&quot;parentUUID&quot;:&quot;33fc72dd-0b6b-44d2-985b-ac917d91160d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9700a15f-4a1c-4998-939b-bd6cd2b90e6f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;16209e0a-0803-4b54-988b-bb8e57785cf4&quot;,&quot;title&quot;:&quot;Module tree tests&quot;,&quot;fullFile&quot;:&quot;/var/www/gabriela/tests/unit/syncModules.spec.js&quot;,&quot;file&quot;:&quot;/tests/unit/syncModules.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create a module and treat it as a collection&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should create a module and treat it as a collection&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;moduleName&#x27;;\nconst mdl = {\n    name: name,\n    preLogicTransformers: [function() {}, function() {}],\n    validators: [function() {}],\n    moduleLogic: [function() {}, function() {}, function() {}],\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\nexpect(g.hasModule(name)).to.be.equal(true);\nexpect(g.getModule(name)).to.be.a(&#x27;object&#x27;);\nmdl.name = &#x27;someOtherName&#x27;;\nconst immutableModule = g.getModule(name);\nexpect(immutableModule.name).to.be.equals(name);\nexpect(immutableModule.preLogicTransformers).to.be.a(&#x27;array&#x27;);\nexpect(immutableModule.validators).to.be.a(&#x27;array&#x27;);\nexpect(immutableModule.moduleLogic).to.be.a(&#x27;array&#x27;);\nexpect(immutableModule.preLogicTransformers.length).to.be.equal(2);\n\nfor (const t of immutableModule.preLogicTransformers) {\n    expect(t).to.be.a(&#x27;function&#x27;);\n}\nexpect(immutableModule.validators.length).to.be.equal(1);\n\nfor (const t of immutableModule.validators) {\n    expect(t).to.be.a(&#x27;function&#x27;);\n}\nexpect(immutableModule.moduleLogic.length).to.be.equal(3);\n\nfor (const t of immutableModule.moduleLogic) {\n    expect(t).to.be.a(&#x27;function&#x27;);\n}\nexpect(g.removeModule(name)).to.be.equal(true);\nexpect(g.hasModule(name)).to.be.false;\nexpect(g.getModule(name)).to.be.a(&#x27;undefined&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8b30bd43-045f-474d-984a-6e521b67f3eb&quot;,&quot;parentUUID&quot;:&quot;16209e0a-0803-4b54-988b-bb8e57785cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should throw error when module definition is invalid&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should throw error when module definition is invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let userModule = {};\nlet g = gabriela.asRunner();\nlet entersException = false;\ntry {\n    g.addModule(userModule);\n} catch(err) {\n    entersException = true;\n    expect(err.message).to.be.equal(`Module definition error. Module has to have a &#x27;name&#x27; property as a string that has to be unique to the project`);\n}\nexpect(entersException).to.be.equal(true);\nuserModule = {\n    name: &#x27;name&#x27;,\n    postLogicTransformers: null,\n};\nentersException = false;\ntry {\n    g.addModule(userModule);\n} catch(err) {\n    entersException = true;\n}\nexpect(entersException).to.be.equal(true);\nconst middlewareNames = [&#x27;preLogicTransformers&#x27;, &#x27;postLogicTransformers&#x27;, &#x27;moduleLogic&#x27;, &#x27;security&#x27;];\nfor (const m of middlewareNames) {\n    userModule = {\n        name: &#x27;name&#x27;,\n    };\n    userModule[m] = null;\n    entersException = false;\n    try {\n        g.addModule(userModule);\n    } catch (err) {\n        entersException = true;\n    }\n    expect(entersException).to.be.equal(true);\n    userModule[m] = [undefined];\n    entersException = false;\n    try {\n        g.addModule(userModule);\n    } catch (err) {\n        entersException = true;\n    }\n    expect(entersException).to.be.equal(true);\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;85c85d1c-47b9-4089-b3c8-d99788d629cf&quot;,&quot;parentUUID&quot;:&quot;16209e0a-0803-4b54-988b-bb8e57785cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert that skip skips the single middleware and not all&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should assert that skip skips the single middleware and not all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;moduleName&#x27;;\nconst model = {\n    name: &#x27;name&#x27;,\n    lastName: &#x27;lastName&#x27;,\n    age: 32\n};\nconst modelCreationTransformer = function(state, next) {\n    state.model = model;\n    next();\n};\nconst ageTransformer = function(state, next, skip) {\n    return skip();\n};\nconst addOption1Property = function(state, next) {\n    state.model.option1 = true;\n    next();\n};\nconst addOption2Property = function(state, next) {\n    state.model.option2 = true;\n    next();\n};\nconst moduleLogic = function(state, next) {\n    state.model.executed = true;\n    next();\n};\nconst mdl = {\n    name: name,\n    preLogicTransformers: [modelCreationTransformer, ageTransformer, addOption1Property, addOption2Property],\n    validators: [],\n    moduleLogic: [moduleLogic],\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult.model.name).to.be.equal(model.name);\n    expect(moduleResult.model.lastName).to.be.equal(model.lastName);\n    expect(moduleResult.model.age).to.be.equal(32);\n    expect(moduleResult.model.executed).to.be.equal(true);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c26a38d8-b47e-4f99-9a96-f87a5756ac56&quot;,&quot;parentUUID&quot;:&quot;16209e0a-0803-4b54-988b-bb8e57785cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert that done skips all middleware and not just the currently executing&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should assert that done skips all middleware and not just the currently executing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;moduleName&#x27;;\nconst model = {\n    name: &#x27;name&#x27;,\n    lastName: &#x27;lastName&#x27;,\n    age: 32\n}\nconst modelCreationTransformer = function(state, next, skip, done) {\n    state.model = model;\n    done();\n}\nconst ageTransformer = function(state, next, skip) {\n    return skip();\n}\nconst addOption1Property = function(state, next) {\n    state.model.option1 = true;\n    next();\n}\nconst addOption2Property = function(state, next) {\n    state.model.option2 = true;\n    next();\n}\nconst moduleLogic = function(state, next) {\n    state.model.executed = true;\n    next();\n}\nconst mdl = {\n    name: name,\n    preLogicTransformers: [modelCreationTransformer, ageTransformer, addOption1Property, addOption2Property],\n    validators: [],\n    moduleLogic: [moduleLogic],\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult.model.name).to.be.equal(model.name);\n    expect(moduleResult.model.lastName).to.be.equal(model.lastName);\n    expect(moduleResult.model.age).to.be.equal(32);\n    expect(moduleResult.model).to.not.have.property(&#x27;executed&#x27;);\n    expect(moduleResult.model).to.not.have.property(&#x27;option1&#x27;);\n    expect(moduleResult.model).to.not.have.property(&#x27;option2&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f8ab757c-aae9-4474-adb4-ad4507625788&quot;,&quot;parentUUID&quot;:&quot;16209e0a-0803-4b54-988b-bb8e57785cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert that preLogicTransformers create and modify the model&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should assert that preLogicTransformers create and modify the model&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;moduleName&#x27;;\nconst model = {\n    name: &#x27;name&#x27;,\n    lastName: &#x27;lastName&#x27;,\n    age: 32\n}\nconst modelCreationTransformer = function(state, next) {\n    state.model = model;\n    next();\n}\nconst ageTransformer = function(state, next) {\n    state.model.age = 25;\n    next();\n}\nconst mdl = {\n    name: name,\n    preLogicTransformers: [modelCreationTransformer, ageTransformer],\n    validators: [],\n    moduleLogic: [],\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult.model.name).to.be.equal(model.name);\n    expect(moduleResult.model.lastName).to.be.equal(model.lastName);\n    expect(moduleResult.model.age).to.be.equal(25);\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8dd79080-108d-432f-baff-50bff5797ac2&quot;,&quot;parentUUID&quot;:&quot;16209e0a-0803-4b54-988b-bb8e57785cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert that validators validate the model&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should assert that validators validate the model&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;moduleName&#x27;;\nconst model = {\n    name: &#x27;name&#x27;,\n    lastName: &#x27;lastName&#x27;,\n    age: 32\n}\nconst modelCreationTransformer = function(state, next) {\n    state.model = model;\n    next();\n}\nconst ageValidator = function(state, next) {\n    if (state.model.age &gt; 25) {\n        throw new Error(&#x27;Invalid models age&#x27;);\n    }\n    return next();\n}\nconst mdl = {\n    name: name,\n    preLogicTransformers: [modelCreationTransformer],\n    validators: [ageValidator],\n    moduleLogic: [],\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then(() =&gt; assert.fail(&#x27;This test should be an error&#x27;)).catch((err) =&gt; {\n    expect(err.message).to.be.equal(&#x27;Invalid models age&#x27;);\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e5a7bea6-a1bd-44c9-aef3-b5539a1aee10&quot;,&quot;parentUUID&quot;:&quot;16209e0a-0803-4b54-988b-bb8e57785cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert that the main logic execution is executed&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should assert that the main logic execution is executed&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;moduleName&#x27;;\nconst model = {\n    name: &#x27;name&#x27;,\n    lastName: &#x27;lastName&#x27;,\n    age: 32\n}\nconst modelCreationTransformer = function(state, next) {\n    state.model = model;\n    next();\n}\nconst logicExec = function(state, next) {\n    state.model.executed = true;\n    next();\n}\nconst mdl = {\n    name: name,\n    preLogicTransformers: [modelCreationTransformer],\n    validators: [],\n    moduleLogic: [logicExec],\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult.model.name).to.be.equal(model.name);\n    expect(moduleResult.model.lastName).to.be.equal(model.lastName);\n    expect(moduleResult.model.age).to.be.equal(32);\n    expect(moduleResult.model).to.have.property(&#x27;executed&#x27;);\n    expect(moduleResult.model.executed).to.be.equal(true);\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ab3a1d4b-e29b-49f7-9ac1-6dff913a952c&quot;,&quot;parentUUID&quot;:&quot;16209e0a-0803-4b54-988b-bb8e57785cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should contain all modules in a tree&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should contain all modules in a tree&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;user&#x27;;\nconst profileModuleName = &#x27;profile&#x27;;\nconst userSettingsModuleName = &#x27;userSettings&#x27;;\nconst user = {\n    email: &#x27;email@gmail.com&#x27;,\n    name: &#x27;name&#x27;,\n    lastName: &#x27;lastName&#x27;,\n    age: 32,\n};\nconst profile = {\n    hobbie: &#x27;Shitting&#x27;,\n    job: &#x27;Programmer&#x27;,\n    timezone: &#x27;Europe/Dublin&#x27;,\n};\nconst userSettings = {\n    colorSetting: &#x27;dark&#x27;,\n    isInNewsletter: true,\n};\nconst userCreationTransformer = function(state, next) {\n    state.model = user;\n    next();\n};\nconst logicExec = function(state, next) {\n    state.model.executed = true;\n    next();\n};\nconst profileChanged = function(state, next) {\n    state.profile.updatedAt = new Date();\n    next();\n};\nconst timezoneValidator = function(state, next) {\n    if (state.profile.timezone !== &#x27;Europe/Dublin&#x27;) {\n        throw new Error(&#x27;Timezone has to be Europe/Dublin&#x27;);\n    }\n    next();\n}\nconst colorSettingChange = function(state, next) {\n    state.userSettings.colorSetting = &#x27;light&#x27;;\n    next();\n}\nconst colorSettingValidator = function(state, next) {\n    const valids = [&#x27;light&#x27;, &#x27;dark&#x27;];\n    if (!valids.includes(state.userSettings.colorSetting)) {\n        throw new Error(&#x27;color setting can only be light or dark&#x27;);\n    }\n    next();\n}\nconst profileModule = {\n    name: profileModuleName,\n    preLogicTransformers: [profileChanged],\n    validators: [timezoneValidator],\n    moduleLogic: [],\n};\nconst userSettingsModule = {\n    name: userSettingsModuleName,\n    preLogicTransformers: [colorSettingChange],\n    validators: [colorSettingValidator],\n    moduleLogic: []\n}\nconst parentModule = {\n    name: name,\n    modules: [profileModule, userSettingsModule],\n    preLogicTransformers: [userCreationTransformer],\n    validators: [],\n    moduleLogic: [logicExec],\n};\nconst g = gabriela.asRunner();\ng.addModule(parentModule);\nexpect(g.parent).to.be.null;\nexpect(g.child).to.be.a(&#x27;object&#x27;);\nexpect(g.child.parent).to.be.a(&#x27;object&#x27;);\nexpect(g.hasModule(name)).to.be.equal(true);\nexpect(g.child.hasModule(profileModuleName)).to.be.equal(true);\nexpect(g.child.hasModule(userSettingsModuleName)).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3438834d-d205-46da-92bc-f66f751eb518&quot;,&quot;parentUUID&quot;:&quot;16209e0a-0803-4b54-988b-bb8e57785cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should run all parent/child modules&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should run all parent/child modules&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;user&#x27;;\nconst profileModuleName = &#x27;profile&#x27;;\nconst userSettingsModuleName = &#x27;userSettings&#x27;;\nconst user = {\n    email: &#x27;email@gmail.com&#x27;,\n    name: &#x27;name&#x27;,\n    lastName: &#x27;lastName&#x27;,\n    age: 32,\n};\nconst profile = {\n    hobbie: &#x27;Shitting&#x27;,\n    job: &#x27;Programmer&#x27;,\n    timezone: &#x27;Europe/Dublin&#x27;,\n};\nconst userSettings = {\n    colorSetting: &#x27;dark&#x27;,\n    isInNewsletter: true,\n};\nconst userCreationTransformer = function(state, next) {\n    state.model = user;\n    next();\n};\nconst profileCreationTransformer = function(state, next) {\n    state.model = profile;\n    next();\n}\nconst userSettingsCreationTransformer = function(state, next) {\n    state.model = userSettings;\n    next();\n}\nconst logicExec = function(state, next) {\n    state.model.executed = true;\n    next();\n};\nconst profileChanged = function(state, next) {\n    state.model.updatedAt = new Date();\n    next();\n};\nconst timezoneValidator = function(state, next) {\n    if (state.model.timezone !== &#x27;Europe/Dublin&#x27;) {\n        throw new Error(&#x27;Timezone has to be Europe/Dublin&#x27;);\n    }\n    next();\n}\nconst colorSettingChange = function(state, next) {\n    state.model.colorSetting = &#x27;light&#x27;;\n    next();\n}\nconst postLogicTransformer = function(state, next) {\n    const user = state.model;\n    const profile = state.child.profile.model;\n    const userSettings = state.child.userSettings.model;\n    user.profile = profile;\n    user.userSettings = userSettings;\n    state.user = user;\n    next();\n}\nconst colorSettingValidator = function(state, next) {\n    const valids = [&#x27;light&#x27;, &#x27;dark&#x27;];\n    if (!valids.includes(state.model.colorSetting)) {\n        throw new Error(&#x27;color setting can only be light or dark&#x27;);\n    }\n    next();\n}\nconst profileModule = {\n    name: profileModuleName,\n    preLogicTransformers: [profileCreationTransformer, profileChanged],\n    validators: [timezoneValidator],\n    moduleLogic: [logicExec],\n};\nconst userSettingsModule = {\n    name: userSettingsModuleName,\n    preLogicTransformers: [userSettingsCreationTransformer, colorSettingChange],\n    validators: [colorSettingValidator],\n    moduleLogic: [logicExec]\n}\nconst parentModule = {\n    name: name,\n    modules: [profileModule, userSettingsModule],\n    preLogicTransformers: [userCreationTransformer],\n    postLogicTransformers: [postLogicTransformer],\n    validators: [],\n    moduleLogic: [logicExec],\n};\nconst g = gabriela.asRunner();\ng.addModule(parentModule);\ng.runModule(parentModule).then((moduleResult) =&gt; {\n    expect(moduleResult).to.have.property(&#x27;user&#x27;)\n    expect(moduleResult.user.executed).to.be.equal(true);\n    expect(moduleResult.user).to.have.property(&#x27;profile&#x27;);\n    expect(moduleResult.user.profile.executed).to.be.equal(true);\n    expect(moduleResult.user).to.have.property(&#x27;userSettings&#x27;);\n    expect(moduleResult.user.userSettings.executed).to.be.equal(true);\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;09f9b458-c1df-4ab8-b5ce-6327900adb5b&quot;,&quot;parentUUID&quot;:&quot;16209e0a-0803-4b54-988b-bb8e57785cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should catch an exception thrown inside the middleware function&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should catch an exception thrown inside the middleware function&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const throwsException = function(state, next, skip, done, throwException) {\n    throwException(new Error(&#x27;my exception&#x27;));\n};\nconst mdl = {\n    name: &#x27;name&#x27;,\n    preLogicTransformers: [throwsException],\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(mdl).catch((err) =&gt; {\n    expect(err.message).to.be.equal(&#x27;my exception&#x27;);\n    done();\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b5b01e91-ce44-4e22-b477-5df0b1592fa0&quot;,&quot;parentUUID&quot;:&quot;16209e0a-0803-4b54-988b-bb8e57785cf4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;8b30bd43-045f-474d-984a-6e521b67f3eb&quot;,&quot;85c85d1c-47b9-4089-b3c8-d99788d629cf&quot;,&quot;c26a38d8-b47e-4f99-9a96-f87a5756ac56&quot;,&quot;f8ab757c-aae9-4474-adb4-ad4507625788&quot;,&quot;8dd79080-108d-432f-baff-50bff5797ac2&quot;,&quot;e5a7bea6-a1bd-44c9-aef3-b5539a1aee10&quot;,&quot;ab3a1d4b-e29b-49f7-9ac1-6dff913a952c&quot;,&quot;3438834d-d205-46da-92bc-f66f751eb518&quot;,&quot;09f9b458-c1df-4ab8-b5ce-6327900adb5b&quot;,&quot;b5b01e91-ce44-4e22-b477-5df0b1592fa0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:13,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;6.1.4&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:true,&quot;reportFilename&quot;:&quot;/var/www/gabriela/tests/mochaawesome/report&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;useInlineDiffs&quot;:false},&quot;version&quot;:&quot;4.0.0&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportFilename&quot;:&quot;/var/www/gabriela/tests/mochaawesome/report&quot;,&quot;quiet&quot;:true},&quot;version&quot;:&quot;4.0.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;/var/www/gabriela/tests/mochaawesome/report&quot;,&quot;reportDir&quot;:&quot;mochawesome-report&quot;,&quot;reportTitle&quot;:&quot;gabriela&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;mochawesome-report/assets&quot;,&quot;jsonFile&quot;:&quot;/var/www/gabriela/tests/mochaawesome/report.json&quot;,&quot;htmlFile&quot;:&quot;/var/www/gabriela/tests/mochaawesome/report.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>