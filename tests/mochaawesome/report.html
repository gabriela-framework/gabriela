<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:6,&quot;tests&quot;:27,&quot;passes&quot;:27,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2019-06-08T19:54:27.620Z&quot;,&quot;end&quot;:&quot;2019-06-08T19:54:29.527Z&quot;,&quot;duration&quot;:1907,&quot;testsRegistered&quot;:27,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;0b739314-bd49-496a-8654-15532a5247c6&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;d83fe9a5-50fd-4a1b-99ed-920a4b3d40b4&quot;,&quot;title&quot;:&quot;Async modules test&quot;,&quot;fullFile&quot;:&quot;/var/www/gabriela/tests/unit/asyncModules.spec.js&quot;,&quot;file&quot;:&quot;/tests/unit/asyncModules.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should assert the first time that next proceedes to next middleware with an async function inside middleware&quot;,&quot;fullTitle&quot;:&quot;Async modules test should assert the first time that next proceedes to next middleware with an async function inside middleware&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:280,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;googleCall&#x27;;\nconst googleRequest = function(state, next) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.googleBody = body;\n        next();\n    });\n};\nconst mdl = {\n    name: name,\n    moduleLogic: [googleRequest]\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult).to.have.property(&#x27;googleBody&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7e817c18-78aa-4361-a83a-c6d124e63408&quot;,&quot;parentUUID&quot;:&quot;d83fe9a5-50fd-4a1b-99ed-920a4b3d40b4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert the second time that next proceedes to next middleware with an async function inside middleware&quot;,&quot;fullTitle&quot;:&quot;Async modules test should assert the second time that next proceedes to next middleware with an async function inside middleware&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:332,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;googleCall&#x27;;\nconst googleRequest = function(state, next) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.googleBody = body;\n        next();\n    });\n};\nconst mdl = {\n    name: name,\n    moduleLogic: [googleRequest]\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult).to.have.property(&#x27;googleBody&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6bf91132-344e-456e-894f-8b661383f901&quot;,&quot;parentUUID&quot;:&quot;d83fe9a5-50fd-4a1b-99ed-920a4b3d40b4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert that skip skips the rest of the middleware&quot;,&quot;fullTitle&quot;:&quot;Async modules test should assert that skip skips the rest of the middleware&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:496,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;googleCall&#x27;;\nconst firstRequest = function(state, next) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.firstRequest = body;\n        next();\n    });\n};\nconst secondRequest = function(state, next, skip) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.secondRequest = body;\n        skip();\n    });\n};\nconst thirdRequest = function(state, next) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.thirdRequest = body;\n        next();\n    });\n};\nconst postLogicTransformer = function(state, next) {\n    state.postLogic = true;\n    next();\n};\nconst mdl = {\n    name: name,\n    moduleLogic: [firstRequest, secondRequest, thirdRequest],\n    postLogicTransformers: [postLogicTransformer]\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult).to.have.property(&#x27;firstRequest&#x27;);\n    expect(moduleResult).to.have.property(&#x27;secondRequest&#x27;);\n    expect(moduleResult).to.not.have.property(&#x27;thirdRequest&#x27;);\n    expect(moduleResult).to.have.property(&#x27;postLogic&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e88850cf-fb83-4b3a-a67e-9e14fd31b594&quot;,&quot;parentUUID&quot;:&quot;d83fe9a5-50fd-4a1b-99ed-920a4b3d40b4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;it should assert that done() exists and does not execute any more middleware&quot;,&quot;fullTitle&quot;:&quot;Async modules test it should assert that done() exists and does not execute any more middleware&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:522,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;googleCall&#x27;;\nconst firstRequest = function(state, next) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.firstRequest = body;\n        next();\n    });\n};\nconst secondRequest = function(state, next, skip, done) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.secondRequest = body;\n        done();\n    });\n};\nconst thirdRequest = function(state, next) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.thirdRequest = body;\n        next();\n    });\n};\nconst postLogicTransformer = function(state, next) {\n    state.postLogic = true;\n    next();\n};\nconst mdl = {\n    name: name,\n    moduleLogic: [firstRequest, secondRequest, thirdRequest],\n    postLogicTransformers: [postLogicTransformer]\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult).to.have.property(&#x27;firstRequest&#x27;);\n    expect(moduleResult).to.have.property(&#x27;secondRequest&#x27;);\n    expect(moduleResult).to.not.have.property(&#x27;thirdRequest&#x27;);\n    expect(moduleResult).to.not.have.property(&#x27;postLogic&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6f07361d-6afd-4f08-89a1-8e43ad3019a7&quot;,&quot;parentUUID&quot;:&quot;d83fe9a5-50fd-4a1b-99ed-920a4b3d40b4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert that exception throw inside middleware async process is caught and processed&quot;,&quot;fullTitle&quot;:&quot;Async modules test should assert that exception throw inside middleware async process is caught and processed&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:187,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;googleCall&#x27;;\nconst firstRequest = function(state, next, skip, done, throwException) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.firstRequest = body;\n        throwException(new Error(&#x27;my exception&#x27;));\n    });\n};\nconst secondRequest = function(state, next, skip, done) {\n    requestPromise.get(&#x27;https://www.google.com/&#x27;).then((body) =&gt; {\n        state.secondRequest = body;\n        done();\n    });\n};\nconst mdl = {\n    name: name,\n    moduleLogic: [firstRequest, secondRequest],\n    postLogicTransformers: []\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n}).catch((err) =&gt; {\n    expect(err.message).to.be.equal(&#x27;my exception&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;da291ca5-c64d-40fc-a7f8-ef4517b8ca7f&quot;,&quot;parentUUID&quot;:&quot;d83fe9a5-50fd-4a1b-99ed-920a4b3d40b4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7e817c18-78aa-4361-a83a-c6d124e63408&quot;,&quot;6bf91132-344e-456e-894f-8b661383f901&quot;,&quot;e88850cf-fb83-4b3a-a67e-9e14fd31b594&quot;,&quot;6f07361d-6afd-4f08-89a1-8e43ad3019a7&quot;,&quot;da291ca5-c64d-40fc-a7f8-ef4517b8ca7f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1817,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;193940f9-72c2-4c0a-80a5-16708084306c&quot;,&quot;title&quot;:&quot;Dependency injection tests&quot;,&quot;fullFile&quot;:&quot;/var/www/gabriela/tests/unit/dependencyInjection.spec.js&quot;,&quot;file&quot;:&quot;/tests/unit/dependencyInjection.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create a single dependency&quot;,&quot;fullTitle&quot;:&quot;Dependency injection tests should create a single dependency&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const userServiceInit = {\n    name: &#x27;userService&#x27;,\n    init: function() {\n        function userService() {\n            this.addUser = function() {};\n            this.removeUser = function() {};\n        }\n        return new userService();\n    }\n};\nconst compiler = Compiler.create();\ncompiler.add(userServiceInit);\nconst userService = compiler.compile(&#x27;userService&#x27;);\nexpect(userService).to.have.property(&#x27;addUser&#x27;);\nexpect(userService).to.have.property(&#x27;removeUser&#x27;);\nlet us1 = compiler.compile(&#x27;userService&#x27;);\nexpect(userService).to.be.equal(us1);\nexpect(us1 == userService).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6bfaa4f5-37b5-4dfe-ab38-054aba7ed55c&quot;,&quot;parentUUID&quot;:&quot;193940f9-72c2-4c0a-80a5-16708084306c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should create a tree of dependencies&quot;,&quot;fullTitle&quot;:&quot;Dependency injection tests should create a tree of dependencies&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const commentServiceInit = {\n    name: &#x27;commentService&#x27;,\n    init: function() {\n        function commentService() {\n            this.addComment = function() {};\n            this.removeComment = function() {};\n        }\n        return new commentService();\n    }\n};\nconst userServiceInit = {\n    name: &#x27;userService&#x27;,\n    init: function(commentService) {\n        function userService() {\n            this.addUser = function() {};\n            this.removeUser = function() {};\n            this.commentService = commentService;\n        }\n        return new userService();\n    }\n};\nconst compiler = Compiler.create();\ncompiler.add(userServiceInit);\ncompiler.add(commentServiceInit);\nconst userService = compiler.compile(&#x27;userService&#x27;);\nexpect(userService).to.have.property(&#x27;addUser&#x27;);\nexpect(userService).to.have.property(&#x27;removeUser&#x27;);\nexpect(userService).to.have.property(&#x27;commentService&#x27;);\nconst commentService = userService.commentService;\nexpect(commentService).to.have.property(&#x27;addComment&#x27;);\nexpect(commentService).to.have.property(&#x27;removeComment&#x27;);\nlet cs1 = compiler.compile(&#x27;commentService&#x27;);\nexpect(cs1 == commentService).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d7a1f75e-b1fe-42a9-a6d2-cebaa9b1e58e&quot;,&quot;parentUUID&quot;:&quot;193940f9-72c2-4c0a-80a5-16708084306c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should resolve dependencies private to a module&quot;,&quot;fullTitle&quot;:&quot;Dependency injection tests should resolve dependencies private to a module&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const commentServiceInit = {\n    name: &#x27;commentService&#x27;,\n    init: function() {\n        function commentService() {\n            this.addComment = function() {};\n            this.removeComment = function() {};\n        }\n        return new commentService();\n    }\n};\nconst userServiceInit = {\n    name: &#x27;userService&#x27;,\n    init: function(commentService) {\n        function userService() {\n            this.addUser = function() {};\n            this.removeUser = function() {};\n            this.commentService = commentService;\n        }\n        return new userService();\n    }\n};&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5bc5fe4a-9481-4e91-8e38-864cdd52cf27&quot;,&quot;parentUUID&quot;:&quot;193940f9-72c2-4c0a-80a5-16708084306c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should resolve all dependencies with visibility property&quot;,&quot;fullTitle&quot;:&quot;Dependency injection tests should resolve all dependencies with visibility property&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const visibilities = [&#x27;module&#x27;, &#x27;plugin&#x27;, &#x27;public&#x27;];\nlet entersException = false;\nconst compiler = Compiler.create();\nfor (const v of visibilities) {\n    entersException = false;\n    try {\n        compiler.add({\n            name: &#x27;name&#x27;,\n            visibility: v,\n            init: function() {\n                return () =&gt; {};\n            },\n        });\n    } catch (err) {\n        entersException = true;\n    }\n    expect(entersException).to.be.equal(false);\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;12616f03-3268-43c9-b598-0be0507cd143&quot;,&quot;parentUUID&quot;:&quot;193940f9-72c2-4c0a-80a5-16708084306c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;6bfaa4f5-37b5-4dfe-ab38-054aba7ed55c&quot;,&quot;d7a1f75e-b1fe-42a9-a6d2-cebaa9b1e58e&quot;,&quot;5bc5fe4a-9481-4e91-8e38-864cdd52cf27&quot;,&quot;12616f03-3268-43c9-b598-0be0507cd143&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e8403b26-c568-4ae5-8280-860a0395b5d2&quot;,&quot;title&quot;:&quot;Failing server tests&quot;,&quot;fullFile&quot;:&quot;/var/www/gabriela/tests/unit/errors.spec.js&quot;,&quot;file&quot;:&quot;/tests/unit/errors.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should validate server options and throw exception&quot;,&quot;fullTitle&quot;:&quot;Failing server tests should validate server options and throw exception&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let entersException = false;\ntry {\n    gabriela.asServer({\n        port: &#x27;invalid&#x27;,\n    });\n} catch (err) {\n    entersException = true;\n}\nexpect(entersException).to.be.equal(true);\ntry {\n    gabriela.asServer({\n        port: 3000,\n        runCallback: null,\n    });\n} catch (err) {\n    entersException = true;\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0ce62f37-b967-4f4a-b857-f7c071b37fcf&quot;,&quot;parentUUID&quot;:&quot;e8403b26-c568-4ae5-8280-860a0395b5d2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0ce62f37-b967-4f4a-b857-f7c071b37fcf&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;9c9bbc2d-562f-4731-ad8d-560e503e4712&quot;,&quot;title&quot;:&quot;Failing DI compiler tests&quot;,&quot;fullFile&quot;:&quot;/var/www/gabriela/tests/unit/errors.spec.js&quot;,&quot;file&quot;:&quot;/tests/unit/errors.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should fail to compile a dependency because init.init does not return a function&quot;,&quot;fullTitle&quot;:&quot;Failing DI compiler tests should fail to compile a dependency because init.init does not return a function&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const userServiceInit = {\n    name: &#x27;userService&#x27;,\n    init: function() {\n        // returns nothing\n    }\n};\nconst compiler = Compiler.create();\ncompiler.add(userServiceInit);\nlet entersException = false;\ntry {\n    compiler.compile(&#x27;userService&#x27;);\n} catch (err) {\n    entersException = true;\n    expect(err.message).to.be.equal(`Dependency injection error. Target service userService cannot be a falsy value`)\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cf954434-8fe2-4f59-877d-a66f315c36de&quot;,&quot;parentUUID&quot;:&quot;9c9bbc2d-562f-4731-ad8d-560e503e4712&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail to compile a dependency because of non existent service&quot;,&quot;fullTitle&quot;:&quot;Failing DI compiler tests should fail to compile a dependency because of non existent service&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let entersException = false;\nconst compiler = Compiler.create();\ntry {\n    compiler.compile(&#x27;nonExistentService&#x27;);\n} catch (err) {\n    entersException = true;\n    expect(err.message).to.be.equal(`Dependency injection error. nonExistentService not found in the dependency tree`)\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e28c122a-26df-4f14-8792-b3e8d1f7de9d&quot;,&quot;parentUUID&quot;:&quot;9c9bbc2d-562f-4731-ad8d-560e503e4712&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail to compile because init dependency value not being an object&quot;,&quot;fullTitle&quot;:&quot;Failing DI compiler tests should fail to compile because init dependency value not being an object&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let entersException = false;\nconst compiler = Compiler.create();\ntry {\n    compiler.add(1);\n} catch (err) {\n    entersException = true;\n    expect(err.message).to.be.equal(`Dependency injection error. &#x27;init&#x27; dependency value must be an object`);\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;80a9c2d5-2b61-4404-9465-61975d85089b&quot;,&quot;parentUUID&quot;:&quot;9c9bbc2d-562f-4731-ad8d-560e503e4712&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail to compile a dependency because name property must be a string&quot;,&quot;fullTitle&quot;:&quot;Failing DI compiler tests should fail to compile a dependency because name property must be a string&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let entersException = false;\nconst compiler = Compiler.create();\ntry {\n    compiler.add({\n        name: 1\n    });\n} catch (err) {\n    entersException = true;\n    expect(err.message).to.be.equal(`Dependency injection error. Init object &#x27;name&#x27; property must be a string`);\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1f1428d8-939e-40df-9bbf-8b119812e168&quot;,&quot;parentUUID&quot;:&quot;9c9bbc2d-562f-4731-ad8d-560e503e4712&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail to compile a dependency because init.init must be a function&quot;,&quot;fullTitle&quot;:&quot;Failing DI compiler tests should fail to compile a dependency because init.init must be a function&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let entersException = false;\nconst compiler = Compiler.create();\ntry {\n    compiler.add({\n        name: &#x27;name&#x27;,\n        init: 1,\n    });\n} catch (err) {\n    entersException = true;\n    expect(err.message).to.be.equal(`Dependency injection error. Init object &#x27;init&#x27; property must be a function`);\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;776d2acc-b381-4875-ac4b-a89fd99d0d5f&quot;,&quot;parentUUID&quot;:&quot;9c9bbc2d-562f-4731-ad8d-560e503e4712&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail to compile because of invalid service name data type&quot;,&quot;fullTitle&quot;:&quot;Failing DI compiler tests should fail to compile because of invalid service name data type&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let entersException = false;\nconst compiler = Compiler.create();\nlet invalidService = {\n    name: 1,\n};\ntry {\n    compiler.add(invalidService);\n} catch (err) {\n    entersException = true;\n}\nexpect(entersException).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a78753f5-4236-469b-a366-c04da82d96c4&quot;,&quot;parentUUID&quot;:&quot;9c9bbc2d-562f-4731-ad8d-560e503e4712&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;cf954434-8fe2-4f59-877d-a66f315c36de&quot;,&quot;e28c122a-26df-4f14-8792-b3e8d1f7de9d&quot;,&quot;80a9c2d5-2b61-4404-9465-61975d85089b&quot;,&quot;1f1428d8-939e-40df-9bbf-8b119812e168&quot;,&quot;776d2acc-b381-4875-ac4b-a89fd99d0d5f&quot;,&quot;a78753f5-4236-469b-a366-c04da82d96c4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;9c66e2fb-b7c0-4fb1-935a-33dd60ab2ff4&quot;,&quot;title&quot;:&quot;Http request to gabriela&quot;,&quot;fullFile&quot;:&quot;/var/www/gabriela/tests/unit/http.spec.js&quot;,&quot;file&quot;:&quot;/tests/unit/http.spec.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Http request to gabriela \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const usersListModule = {\n    http: {\n        route: {\n            name: &#x27;usersList&#x27;,\n            path: &#x27;/users&#x27;,\n            method: &#x27;get&#x27;,\n        }\n    },\n    name: &#x27;name&#x27;,\n    moduleLogic: [(state, next, skip, done, throwException, http) =&gt; {\n        http.res.send(&#x27;OK&#x27;);\n        http.res.end();\n        done();\n    }],\n};\ngabrielaServer = gabriela.asServer({\n    port: 3001,\n    runCallback: () =&gt; {\n        done();\n    }\n});\ngabrielaServer.addModule(usersListModule);\ngabrielaServer.runServer();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eff8293f-669a-4590-bcd9-7f3051949420&quot;,&quot;parentUUID&quot;:&quot;9c66e2fb-b7c0-4fb1-935a-33dd60ab2ff4&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;Http request to gabriela \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;gabrielaServer.closeServer();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c729bf77-8f29-4c1d-ac96-d5540c66b9a9&quot;,&quot;parentUUID&quot;:&quot;9c66e2fb-b7c0-4fb1-935a-33dd60ab2ff4&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;should accept a GET request and return a response&quot;,&quot;fullTitle&quot;:&quot;Http request to gabriela should accept a GET request and return a response&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;requestPromise(&#x27;http://11.11.11.12:3001/users&#x27;).then((body) =&gt; {\n    expect(body).to.be.equal(&#x27;OK&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b653e474-5059-4648-bacb-2638950114df&quot;,&quot;parentUUID&quot;:&quot;9c66e2fb-b7c0-4fb1-935a-33dd60ab2ff4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b653e474-5059-4648-bacb-2638950114df&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;35bdb126-17ed-4527-9b1d-7284bb9a4c43&quot;,&quot;title&quot;:&quot;Module tree tests&quot;,&quot;fullFile&quot;:&quot;/var/www/gabriela/tests/unit/syncModules.spec.js&quot;,&quot;file&quot;:&quot;/tests/unit/syncModules.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create a module and treat it as a collection&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should create a module and treat it as a collection&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;moduleName&#x27;;\nconst mdl = {\n    name: name,\n    preLogicTransformers: [function() {}, function() {}],\n    validators: [function() {}],\n    moduleLogic: [function() {}, function() {}, function() {}],\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\nexpect(g.hasModule(name)).to.be.equal(true);\nexpect(g.getModule(name)).to.be.a(&#x27;object&#x27;);\nmdl.name = &#x27;someOtherName&#x27;;\nconst immutableModule = g.getModule(name);\nexpect(immutableModule.name).to.be.equals(name);\nexpect(immutableModule.preLogicTransformers).to.be.a(&#x27;array&#x27;);\nexpect(immutableModule.validators).to.be.a(&#x27;array&#x27;);\nexpect(immutableModule.moduleLogic).to.be.a(&#x27;array&#x27;);\nexpect(immutableModule.preLogicTransformers.length).to.be.equal(2);\n\nfor (const t of immutableModule.preLogicTransformers) {\n    expect(t).to.be.a(&#x27;function&#x27;);\n}\nexpect(immutableModule.validators.length).to.be.equal(1);\n\nfor (const t of immutableModule.validators) {\n    expect(t).to.be.a(&#x27;function&#x27;);\n}\nexpect(immutableModule.moduleLogic.length).to.be.equal(3);\n\nfor (const t of immutableModule.moduleLogic) {\n    expect(t).to.be.a(&#x27;function&#x27;);\n}\nexpect(g.removeModule(name)).to.be.equal(true);\nexpect(g.hasModule(name)).to.be.false;\nexpect(g.getModule(name)).to.be.a(&#x27;undefined&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;da6f3ca8-7f1e-4d83-b827-b1a61e169fac&quot;,&quot;parentUUID&quot;:&quot;35bdb126-17ed-4527-9b1d-7284bb9a4c43&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should throw error when module definition is invalid&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should throw error when module definition is invalid&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let userModule = {};\nlet g = gabriela.asRunner();\nlet entersException = false;\ntry {\n    g.addModule(userModule);\n} catch(err) {\n    entersException = true;\n    expect(err.message).to.be.equal(`Module definition error. Module has to have a &#x27;name&#x27; property as a string that has to be unique to the project`);\n}\nexpect(entersException).to.be.equal(true);\nuserModule = {\n    name: &#x27;name&#x27;,\n    postLogicTransformers: null,\n};\nentersException = false;\ntry {\n    g.addModule(userModule);\n} catch(err) {\n    entersException = true;\n}\nexpect(entersException).to.be.equal(true);\nconst middlewareNames = [&#x27;preLogicTransformers&#x27;, &#x27;postLogicTransformers&#x27;, &#x27;moduleLogic&#x27;, &#x27;security&#x27;];\nfor (const m of middlewareNames) {\n    userModule = {\n        name: &#x27;name&#x27;,\n    };\n    userModule[m] = null;\n    entersException = false;\n    try {\n        g.addModule(userModule);\n    } catch (err) {\n        entersException = true;\n    }\n    expect(entersException).to.be.equal(true);\n    userModule[m] = [undefined];\n    entersException = false;\n    try {\n        g.addModule(userModule);\n    } catch (err) {\n        entersException = true;\n    }\n    expect(entersException).to.be.equal(true);\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cfa4b5ba-873b-4681-b176-b6ce0ae33b72&quot;,&quot;parentUUID&quot;:&quot;35bdb126-17ed-4527-9b1d-7284bb9a4c43&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert that skip skips the single middleware and not all&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should assert that skip skips the single middleware and not all&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;moduleName&#x27;;\nconst model = {\n    name: &#x27;name&#x27;,\n    lastName: &#x27;lastName&#x27;,\n    age: 32\n};\nconst modelCreationTransformer = function(state, next) {\n    state.model = model;\n    next();\n};\nconst ageTransformer = function(state, next, skip) {\n    return skip();\n};\nconst addOption1Property = function(state, next) {\n    state.model.option1 = true;\n    next();\n};\nconst addOption2Property = function(state, next) {\n    state.model.option2 = true;\n    next();\n};\nconst moduleLogic = function(state, next) {\n    state.model.executed = true;\n    next();\n};\nconst mdl = {\n    name: name,\n    preLogicTransformers: [modelCreationTransformer, ageTransformer, addOption1Property, addOption2Property],\n    validators: [],\n    moduleLogic: [moduleLogic],\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult.model.name).to.be.equal(model.name);\n    expect(moduleResult.model.lastName).to.be.equal(model.lastName);\n    expect(moduleResult.model.age).to.be.equal(32);\n    expect(moduleResult.model.executed).to.be.equal(true);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b6abc1fa-d219-4964-9e14-c6b13047cdab&quot;,&quot;parentUUID&quot;:&quot;35bdb126-17ed-4527-9b1d-7284bb9a4c43&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert that done skips all middleware and not just the currently executing&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should assert that done skips all middleware and not just the currently executing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;moduleName&#x27;;\nconst model = {\n    name: &#x27;name&#x27;,\n    lastName: &#x27;lastName&#x27;,\n    age: 32\n}\nconst modelCreationTransformer = function(state, next, skip, done) {\n    state.model = model;\n    done();\n}\nconst ageTransformer = function(state, next, skip) {\n    return skip();\n}\nconst addOption1Property = function(state, next) {\n    state.model.option1 = true;\n    next();\n}\nconst addOption2Property = function(state, next) {\n    state.model.option2 = true;\n    next();\n}\nconst moduleLogic = function(state, next) {\n    state.model.executed = true;\n    next();\n}\nconst mdl = {\n    name: name,\n    preLogicTransformers: [modelCreationTransformer, ageTransformer, addOption1Property, addOption2Property],\n    validators: [],\n    moduleLogic: [moduleLogic],\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult.model.name).to.be.equal(model.name);\n    expect(moduleResult.model.lastName).to.be.equal(model.lastName);\n    expect(moduleResult.model.age).to.be.equal(32);\n    expect(moduleResult.model).to.not.have.property(&#x27;executed&#x27;);\n    expect(moduleResult.model).to.not.have.property(&#x27;option1&#x27;);\n    expect(moduleResult.model).to.not.have.property(&#x27;option2&#x27;);\n    done();\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e60b8985-0e0d-4a23-b571-1761194c3aac&quot;,&quot;parentUUID&quot;:&quot;35bdb126-17ed-4527-9b1d-7284bb9a4c43&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert that preLogicTransformers create and modify the model&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should assert that preLogicTransformers create and modify the model&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;moduleName&#x27;;\nconst model = {\n    name: &#x27;name&#x27;,\n    lastName: &#x27;lastName&#x27;,\n    age: 32\n}\nconst modelCreationTransformer = function(state, next) {\n    state.model = model;\n    next();\n}\nconst ageTransformer = function(state, next) {\n    state.model.age = 25;\n    next();\n}\nconst mdl = {\n    name: name,\n    preLogicTransformers: [modelCreationTransformer, ageTransformer],\n    validators: [],\n    moduleLogic: [],\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult.model.name).to.be.equal(model.name);\n    expect(moduleResult.model.lastName).to.be.equal(model.lastName);\n    expect(moduleResult.model.age).to.be.equal(25);\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7b7243d7-dce1-408d-b226-c99931ac2f61&quot;,&quot;parentUUID&quot;:&quot;35bdb126-17ed-4527-9b1d-7284bb9a4c43&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert that validators validate the model&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should assert that validators validate the model&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;moduleName&#x27;;\nconst model = {\n    name: &#x27;name&#x27;,\n    lastName: &#x27;lastName&#x27;,\n    age: 32\n}\nconst modelCreationTransformer = function(state, next) {\n    state.model = model;\n    next();\n}\nconst ageValidator = function(state, next) {\n    if (state.model.age &gt; 25) {\n        throw new Error(&#x27;Invalid models age&#x27;);\n    }\n    return next();\n}\nconst mdl = {\n    name: name,\n    preLogicTransformers: [modelCreationTransformer],\n    validators: [ageValidator],\n    moduleLogic: [],\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then(() =&gt; assert.fail(&#x27;This test should be an error&#x27;)).catch((err) =&gt; {\n    expect(err.message).to.be.equal(&#x27;Invalid models age&#x27;);\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;04c51d6a-e82e-4b8e-a76a-cbaa8d46403d&quot;,&quot;parentUUID&quot;:&quot;35bdb126-17ed-4527-9b1d-7284bb9a4c43&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should assert that the main logic execution is executed&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should assert that the main logic execution is executed&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;moduleName&#x27;;\nconst model = {\n    name: &#x27;name&#x27;,\n    lastName: &#x27;lastName&#x27;,\n    age: 32\n}\nconst modelCreationTransformer = function(state, next) {\n    state.model = model;\n    next();\n}\nconst logicExec = function(state, next) {\n    state.model.executed = true;\n    next();\n}\nconst mdl = {\n    name: name,\n    preLogicTransformers: [modelCreationTransformer],\n    validators: [],\n    moduleLogic: [logicExec],\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(g.getModule(name)).then((moduleResult) =&gt; {\n    expect(moduleResult.model.name).to.be.equal(model.name);\n    expect(moduleResult.model.lastName).to.be.equal(model.lastName);\n    expect(moduleResult.model.age).to.be.equal(32);\n    expect(moduleResult.model).to.have.property(&#x27;executed&#x27;);\n    expect(moduleResult.model.executed).to.be.equal(true);\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3af240b4-2e68-483d-94c2-20f0c09b8833&quot;,&quot;parentUUID&quot;:&quot;35bdb126-17ed-4527-9b1d-7284bb9a4c43&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should contain all modules in a tree&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should contain all modules in a tree&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;user&#x27;;\nconst profileModuleName = &#x27;profile&#x27;;\nconst userSettingsModuleName = &#x27;userSettings&#x27;;\nconst user = {\n    email: &#x27;email@gmail.com&#x27;,\n    name: &#x27;name&#x27;,\n    lastName: &#x27;lastName&#x27;,\n    age: 32,\n};\nconst profile = {\n    hobbie: &#x27;Shitting&#x27;,\n    job: &#x27;Programmer&#x27;,\n    timezone: &#x27;Europe/Dublin&#x27;,\n};\nconst userSettings = {\n    colorSetting: &#x27;dark&#x27;,\n    isInNewsletter: true,\n};\nconst userCreationTransformer = function(state, next) {\n    state.model = user;\n    next();\n};\nconst logicExec = function(state, next) {\n    state.model.executed = true;\n    next();\n};\nconst profileChanged = function(state, next) {\n    state.profile.updatedAt = new Date();\n    next();\n};\nconst timezoneValidator = function(state, next) {\n    if (state.profile.timezone !== &#x27;Europe/Dublin&#x27;) {\n        throw new Error(&#x27;Timezone has to be Europe/Dublin&#x27;);\n    }\n    next();\n}\nconst colorSettingChange = function(state, next) {\n    state.userSettings.colorSetting = &#x27;light&#x27;;\n    next();\n}\nconst colorSettingValidator = function(state, next) {\n    const valids = [&#x27;light&#x27;, &#x27;dark&#x27;];\n    if (!valids.includes(state.userSettings.colorSetting)) {\n        throw new Error(&#x27;color setting can only be light or dark&#x27;);\n    }\n    next();\n}\nconst profileModule = {\n    name: profileModuleName,\n    preLogicTransformers: [profileChanged],\n    validators: [timezoneValidator],\n    moduleLogic: [],\n};\nconst userSettingsModule = {\n    name: userSettingsModuleName,\n    preLogicTransformers: [colorSettingChange],\n    validators: [colorSettingValidator],\n    moduleLogic: []\n}\nconst parentModule = {\n    name: name,\n    modules: [profileModule, userSettingsModule],\n    preLogicTransformers: [userCreationTransformer],\n    validators: [],\n    moduleLogic: [logicExec],\n};\nconst g = gabriela.asRunner();\ng.addModule(parentModule);\nexpect(g.parent).to.be.null;\nexpect(g.child).to.be.a(&#x27;object&#x27;);\nexpect(g.child.parent).to.be.a(&#x27;object&#x27;);\nexpect(g.hasModule(name)).to.be.equal(true);\nexpect(g.child.hasModule(profileModuleName)).to.be.equal(true);\nexpect(g.child.hasModule(userSettingsModuleName)).to.be.equal(true);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fb0e63b3-0e9b-43e4-891b-a267cc9fc43e&quot;,&quot;parentUUID&quot;:&quot;35bdb126-17ed-4527-9b1d-7284bb9a4c43&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should run all parent/child modules&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should run all parent/child modules&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const name = &#x27;user&#x27;;\nconst profileModuleName = &#x27;profile&#x27;;\nconst userSettingsModuleName = &#x27;userSettings&#x27;;\nconst user = {\n    email: &#x27;email@gmail.com&#x27;,\n    name: &#x27;name&#x27;,\n    lastName: &#x27;lastName&#x27;,\n    age: 32,\n};\nconst profile = {\n    hobbie: &#x27;Shitting&#x27;,\n    job: &#x27;Programmer&#x27;,\n    timezone: &#x27;Europe/Dublin&#x27;,\n};\nconst userSettings = {\n    colorSetting: &#x27;dark&#x27;,\n    isInNewsletter: true,\n};\nconst userCreationTransformer = function(state, next) {\n    state.model = user;\n    next();\n};\nconst profileCreationTransformer = function(state, next) {\n    state.model = profile;\n    next();\n}\nconst userSettingsCreationTransformer = function(state, next) {\n    state.model = userSettings;\n    next();\n}\nconst logicExec = function(state, next) {\n    state.model.executed = true;\n    next();\n};\nconst profileChanged = function(state, next) {\n    state.model.updatedAt = new Date();\n    next();\n};\nconst timezoneValidator = function(state, next) {\n    if (state.model.timezone !== &#x27;Europe/Dublin&#x27;) {\n        throw new Error(&#x27;Timezone has to be Europe/Dublin&#x27;);\n    }\n    next();\n}\nconst colorSettingChange = function(state, next) {\n    state.model.colorSetting = &#x27;light&#x27;;\n    next();\n}\nconst postLogicTransformer = function(state, next) {\n    const user = state.model;\n    const profile = state.child.profile.model;\n    const userSettings = state.child.userSettings.model;\n    user.profile = profile;\n    user.userSettings = userSettings;\n    state.user = user;\n    next();\n}\nconst colorSettingValidator = function(state, next) {\n    const valids = [&#x27;light&#x27;, &#x27;dark&#x27;];\n    if (!valids.includes(state.model.colorSetting)) {\n        throw new Error(&#x27;color setting can only be light or dark&#x27;);\n    }\n    next();\n}\nconst profileModule = {\n    name: profileModuleName,\n    preLogicTransformers: [profileCreationTransformer, profileChanged],\n    validators: [timezoneValidator],\n    moduleLogic: [logicExec],\n};\nconst userSettingsModule = {\n    name: userSettingsModuleName,\n    preLogicTransformers: [userSettingsCreationTransformer, colorSettingChange],\n    validators: [colorSettingValidator],\n    moduleLogic: [logicExec]\n}\nconst parentModule = {\n    name: name,\n    modules: [profileModule, userSettingsModule],\n    preLogicTransformers: [userCreationTransformer],\n    postLogicTransformers: [postLogicTransformer],\n    validators: [],\n    moduleLogic: [logicExec],\n};\nconst g = gabriela.asRunner();\ng.addModule(parentModule);\ng.runModule(parentModule).then((moduleResult) =&gt; {\n    expect(moduleResult).to.have.property(&#x27;user&#x27;)\n    expect(moduleResult.user.executed).to.be.equal(true);\n    expect(moduleResult.user).to.have.property(&#x27;profile&#x27;);\n    expect(moduleResult.user.profile.executed).to.be.equal(true);\n    expect(moduleResult.user).to.have.property(&#x27;userSettings&#x27;);\n    expect(moduleResult.user.userSettings.executed).to.be.equal(true);\n});&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3b2e37ee-a418-4b91-be7d-6f0a36fc2bb8&quot;,&quot;parentUUID&quot;:&quot;35bdb126-17ed-4527-9b1d-7284bb9a4c43&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should catch an exception thrown inside the middleware function&quot;,&quot;fullTitle&quot;:&quot;Module tree tests should catch an exception thrown inside the middleware function&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const throwsException = function(state, next, skip, done, throwException) {\n    throwException(new Error(&#x27;my exception&#x27;));\n};\nconst mdl = {\n    name: &#x27;name&#x27;,\n    preLogicTransformers: [throwsException],\n};\nconst g = gabriela.asRunner();\ng.addModule(mdl);\ng.runModule(mdl).catch((err) =&gt; {\n    expect(err.message).to.be.equal(&#x27;my exception&#x27;);\n    done();\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;69de75f8-ca17-4da7-a04a-b93a71bec65b&quot;,&quot;parentUUID&quot;:&quot;35bdb126-17ed-4527-9b1d-7284bb9a4c43&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;da6f3ca8-7f1e-4d83-b827-b1a61e169fac&quot;,&quot;cfa4b5ba-873b-4681-b176-b6ce0ae33b72&quot;,&quot;b6abc1fa-d219-4964-9e14-c6b13047cdab&quot;,&quot;e60b8985-0e0d-4a23-b571-1761194c3aac&quot;,&quot;7b7243d7-dce1-408d-b226-c99931ac2f61&quot;,&quot;04c51d6a-e82e-4b8e-a76a-cbaa8d46403d&quot;,&quot;3af240b4-2e68-483d-94c2-20f0c09b8833&quot;,&quot;fb0e63b3-0e9b-43e4-891b-a267cc9fc43e&quot;,&quot;3b2e37ee-a418-4b91-be7d-6f0a36fc2bb8&quot;,&quot;69de75f8-ca17-4da7-a04a-b93a71bec65b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:15,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;6.1.4&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:true,&quot;reportFilename&quot;:&quot;/var/www/gabriela/tests/mochaawesome/report&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;useInlineDiffs&quot;:false},&quot;version&quot;:&quot;4.0.0&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportFilename&quot;:&quot;/var/www/gabriela/tests/mochaawesome/report&quot;,&quot;quiet&quot;:true},&quot;version&quot;:&quot;4.0.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;/var/www/gabriela/tests/mochaawesome/report&quot;,&quot;reportDir&quot;:&quot;mochawesome-report&quot;,&quot;reportTitle&quot;:&quot;gabriela&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;mochawesome-report/assets&quot;,&quot;jsonFile&quot;:&quot;/var/www/gabriela/tests/mochaawesome/report.json&quot;,&quot;htmlFile&quot;:&quot;/var/www/gabriela/tests/mochaawesome/report.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>